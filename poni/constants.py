import numpy as np


REGISTERED_DATASETS = ["gibson", "mp3d", "hm3d"]
SPLIT_SCENES = {
    "gibson": {
        "train": [
            "Allensville",
            "Beechwood",
            "Marstons",
            "Benevolence",
            "Merom",
            "Coffeen",
            "Mifflinburg",
            "Newfields",
            "Onaga",
            "Cosmos",
            "Pinesdale",
            "Pomaria",
            "Forkland",
            "Ranchester",
            "Hanson",
            "Shelbyville",
            "Hiteman",
            "Stockman",
            "Klickitat",
            "Tolstoy",
            "Lakeville",
            "Wainscott",
            "Leonardo",
            "Lindenwood",
            "Woodbine",
        ],
        "val": [
            "Darden",
            "Collierville",
            "Markleeville",
            "Wiconisco",
            "Corozal ",
        ],
    },
    "mp3d": {
        "train": [
            "17DRP5sb8fy",
            "1LXtFkjw3qL",
            "1pXnuDYAj8r",
            "29hnd4uzFmX",
            "5LpN3gDmAk7",
            "5q7pvUzZiYa",
            "759xd9YjKW5",
            "7y3sRwLe3Va",
            "82sE5b5pLXE",
            "8WUmhLawc2A",
            "B6ByNegPMKs",
            "D7G3Y4RVNrH",
            "D7N2EKCX4Sj",
            "E9uDoFAP3SH",
            "EDJbREhghzL",
            "GdvgFV5R1Z5",
            "HxpKQynjfin",
            "JF19kD82Mey",
            "JeFG25nYj2p",
            "PX4nDJXEHrG",
            "Pm6F8kyY3z2",
            "PuKPg4mmafe",
            "S9hNv5qa7GM",
            "ULsKaCPVFJR",
            "Uxmj2M2itWa",
            "V2XKFyX4ASd",
            "VFuaQ6m2Qom",
            "VLzqgDo317F",
            "VVfe2KiqLaN",
            "Vvot9Ly1tCj",
            "XcA2TqTSSAj",
            "YmJkqBEsHnH",
            "ZMojNkEp431",
            "aayBHfsNo7d",
            "ac26ZMwG7aT",
            "b8cTxDM8gDG",
            "cV4RVeZvu5T",
            "dhjEzFoUFzH",
            "e9zR4mvMWw7",
            "gZ6f7yhEvPG",
            "i5noydFURQK",
            "jh4fc5c5qoQ",
            "kEZ7cmS4wCh",
            "mJXqzFtmKg4",
            "p5wJjkQkbXX",
            "pRbA3pwrgk9",
            "qoiz87JEwZ2",
            "r1Q1Z4BcV1o",
            "r47D5H71a5s",
            "rPc6DW4iMge",
            "s8pcmisQ38h",
            "sKLMLpTHeUy",
            "sT4fr6TAbpF",
            "uNb9QFRL6hY",
            "ur6pFq6Qu1A",
            "vyrNrziPKCB",
        ],
        "val": [
            "2azQ1b91cZZ",
            "8194nk5LbLH",
            "EU6Fwq7SyZv",
            "QUCTc6BB5sX",
            "TbHJrupSAjP",
            "X7HyMhZNoso",
            "Z6MFQCViBuw",
            "oLBMNvg9in8",
            "pLe4wQe7qrG",
            "x8F5xyUWy9e",
            "zsNo4HB9uLZ",
        ],
    },
    "hm3d": {
        "train": [
        "5RtSdesLuHt",
        "LPEMkRVudUm",
        "yQESfVcg18k",
        "erXNfWVjqZ8",
        "Y8Y6ukxGMvn",
        "rihBP3nC6p4",
        "qkkRnWghK8e",
        "1K7P6ZQS4VM",
        "TGVJHgmMGzi",
        "1SedVoP7zLu",
        "R6Byftz8wRN",
        "mQFC1yx29MM",
        "BUFVGDCQNGb",
        "JHHVv6QZJMm",
        "zwzTbNq7xoW",
        "TQSiMZJawkS",
        "C8VQQtzUoqV",
        "GsQBY83r3hb",
        "M8PMwoYQTUV",
        "3YSDRj9kTU7",
        "99ML7CGPqsQ",
        "GGBvSFddQgs",
        "xc2kFoo9nbw",
        "q9CAdKfvar2",
        "YmWinf3mhb5",
        "aKwZ7VJDAjr",
        "QE33dvXyf1U",
        "gyK27yu7CP4",
        "rBmEe6ab5VP",
        "L5QEsaVqwrY",
        "ZxkSUELrWtQ",
        "pcpn6mFqFCg",
        "xccdSFAEPau",
        "as8Y8AYx6yW",
        "NBuk4gePdJm",
        "BfzKZxFShtq",
        "CETmJJqkhcK",
        "4euAVjDbkz9",
        "gQgtJ9Stk5s",
        "asrq4PFvdvF",
        "5uXtMs57HmZ",
        "R9fYpvCUkV7",
        "NBWrHFXBF5p",
        "Jfyvj3xn2aJ",
        "27cQLjQ5CjV",
        "9oGV6Y9nNqB",
        "HxmXPBbFCkH",
        "cWfRoQnzNiM",
        "RrfVebebfWf",
        "JNiWU5TZLtt",
        "w7QyjJ3H9Bp",
        "1zDbEdygBeW",
        "tYvWp85L81G",
        "eAUmfFLZDR3",
        "MHYu4LWb6qP",
        "CKbwkKufMWM",
        "8uSpPmctPXC",
        "yA3RqPqMrGE",
        "A1jHexSJuAW",
        "FXuXGH9YQTW",
        "Wo6kuutE9i7",
        "YMNvYDhK8mB",
        "rzzVnFnBLtg",
        "QFjJExB2jgE",
        "6HRFAUDqpTb",
        "jG9pucmJVBZ",
        "KJxdMPgweZG",
        "DACaFbApXUe",
        "JSgMy8tTACD",
        "yX5efd48dLf",
        "TZ2jsvNG2nt",
        "APXAdV48nKT",
        "MfkErJj6CHF",
        "dcd823nTKH9",
        "PE6kVEtrxtj",
        "fc7RfUCN5mY",
        "pAjDzi9kWjE",
        "6EMViBCA2N7",
        "8oSQng53cGV",
        "VSxVP19Cdyw",
        "vjMVcmpC1hC",
        "JjsvQEqRxGS",
        "KjZrPggnHm8",
        "DBBESbk4Y3k",
        "nHHVbEyHX3t",
        "AMEM2eWycTq",
        "JiHGQpwKUvd",
        "qxwfVS8MQ67",
        "WpVxtsP4xxA",
        "3CBBjsNkhqW",
        "zepmXAdrpjR",
        "Umx6CdjZfvy",
        "Z2DQddYp1fn",
        "12e6joG2B2T",
        "H1D2FZ8TAv1",
        "YV9M9gZG3YJ",
        "1Rg1SS1dRpG",
        "ytXtEYghmvL",
        "n8AnEznQQpv",
        "bvdRzJBgJyg",
        "3XYAD64HpDr",
        "WRphMcFxfhe",
        "741Fdj7NLF9",
        "4L4peQsMgfR",
        "kCHmLFfMDuE",
        "yogvKWUrdnw",
        "hTTnuAeSN6d",
        "fKP4sxcoxpL",
        "kyoZhaD9HuW",
        "j2Nms3h9XJv",
        "kfPV7w3FaU5",
        "oQPVc6vwgaq",
        "4GfZ9TTZUwL",
        "janiYDpzM9j",
        "FgswoxWb3uN",
        "BJovXQkqbC3",
        "qZ4B7U6XE5Y",
        "b2e31HFFizw",
        "4h4JxvG3cip",
        "T48WJA2vtru",
        "W16Bm4ysK8v",
        "bMvM1KL4WsR",
        "xvDx98avcwd",
        "Ty7djLDxQu3",
        "uHnM1oqv2JL",
        "C3ifY177Ldq",
        "JY8e73x9ubE",
        "LpFSk2s7me6",
        "sjH1uaR68XQ",
        "q6tn1ZjSsG4",
        "SBHLgvFTVMZ",
        "JPMDv7zL4bF",
        "Lva3QmSMsTr",
        "HLBJGGyicLV",
        "YWy9hV7RfQB",
        "TSJmdttd2GV",
        "kAMF2R7PCqX",
        "HeSYRw7eMtG",
        "nMeXfQU4PMS",
        "mjvN6RDLsPm",
        "8QtyGUUtacf",
        "P3hmFK6Ejnf",
        "GcfUJ79xCZc",
        "QDvRVeWFCjM",
        "RiwBKy2YdQ7",
        "RYzud5W7ZnC",
        "NGyoyh91xXJ",
        "UZ5rYGiwQgW",
        "5Kw4nGdqYtS",
        "DqJKU7YU7dA",
        "SSwbmq72C21",
        "drvaU627cQh",
        "qk9eeNeR4vw",
        "sCCThjhioJC",
        "k17yptqNRAn",
        "JptJPosx1Z6",
        "g8Xrdbe9fir",
        "W4r5JssudHR",
        "rrjjmoZhZCo",
        "boJrpwDQtu9",
        "nJTPfwbAj4S",
        "NieWWMV6tE4",
        "gamLwhSzHci",
        "iLDo95ZbDJq",
        "YmEfzspXX5h",
        "7dmR22gwQpH",
        "BcZUZQ9t4Fe",
        "vPoFkhqsJaf",
        "6ySDHVkso9e",
        "xcTV5UHYHFV",
        "uc8QkFS11Hj",
        "XYyR54sxe6b",
        "ochRmQAHtkF",
        "9hJwm8k7Gka",
        "3iZkJUc7KhX",
        "5Poh4Qz68hd",
        "WpAGGyZFqQj",
        "JXdzHne1mRo",
        "kuxpR2xHUBa",
        "wxixLWuvLjd",
        "tzaZQQmUVXZ",
        "iigzG1rtanx",
        "mt9H8KcxRKD",
        "tTcuEfoAQXv",
        "kGVKV9k9DCT",
        "yPKGKBCyYx8",
        "zJ3fVx3BZYR",
        "ENhuWpDE5EB",
        "csHQLLFPE3g",
        "92vYG1q49FY",
        "sNikFfBW8zM",
        "3UDjdrwcqMb",
        "9SpHCfHaNiG",
        "6imZUJGRUq4",
        "oPj9qMxrDEa",
        "dQrLTxHvLXU",
        "6YtDG3FhNvx",
        "dKySjDYsya1",
        "67ADtrTrBK2",
        "FRQ75PjD278",
        "N8oi63yAP2b",
        "ZB8o8rMmPdB",
        "tL6i2PtktSh",
        "iQPq34e8hJX",
        "ki6Cu76pWzF",
        "s19Uyn7AWwv",
        "2dZ1Jivh5if",
        "FcUgaJv6JHA",
        "6r9GfBG7u1g",
        "ASKXmHbw68X",
        "panm7DRsmDn",
        "krsjseyn6fd",
        "GTV2Y73Sn5t",
        "PK83UqrXjd3",
        "DGXRxHddGAW",
        "zhzot8MvSjF",
        "uXh7Yr7x12L",
        "1sM6KvYg3J5",
        "YGc1h9nNrJP",
        "5K2dTSVihN7",
        "1k479icNeHW",
        "bB6nKqfsb1z",
        "hmRxh2mmzNC",
        "CFVBbU9Rsyb",
        "wz9FcGhrndc",
        "F5j7ZLfMm1n",
        "RfNGMBdVbAZ",
        "DWsM2ficpne",
        "DwDDvGo9QdA",
        "MjzBosUX3WW",
        "w3ZK3Wxvidz",
        "ooq3SnvC79d",
        "fJ1GEE6PdHD",
        "8qbZhbTc1wX",
        "PXAfUkZGMdU",
        "2tqbn5VLQoq",
        "aosjAwX5Lnq",
        "knPYW3fibqY",
        "VKmpsujnc5t",
        "sX9xad6ULKc",
        "hkmLgL6jrP8",
        "wDDRygUCLMm",
        "D2PqRE5ZvyQ",
        "7GvCP12M9fi",
        "dDyovSFuViJ",
        "GtqoUWABJ11",
        "bdp1XNEdvmW",
        "XKqDR74W1JU",
        "ZNanfzgCdm3",
        "UVdNNRcVyV1",
        "VqCaAuuoeWk",
        "Pmv1pdeirDT",
        "4dtmWCb8CDk",
        "7CXbc73tDRf",
        "GMwtBqNLGBs",
        "kHvNo8x6Qoe",
        "sWAdxSLVPQC",
        "y3dZtLZCUvN",
        "1wypxmRjuUR",
        "S3r45BMWy6H",
        "BEuB32yj7Fb",
        "VWczCD1Hbus",
        "UfhK7KNBg5u",
        "T22dejNjHK7",
        "YHmAkqgwe2p",
        "vLpv2VX547B",
        "WhNyDTnd9g5",
        "PaQrTquNd2v",
        "VYnUX657cVo",
        "S9M7ybC5ZHu",
        "x1pTUWx9DPr",
        "yCCyNxubYcL",
        "u3zrj4Nojev",
        "NpCFg9NdUgL",
        "wFCLkVy4n9U",
        "UrFKpVJpvHi",
        "w8GiikYuFRk",
        "m49MsVC7BwA",
        "gmLDom6XSo7",
        "wPLokgvCnuk",
        "UQuchpekHRJ",
        "g7hUFVNac26",
        "tj8ngv3woJ3",
        "wsAYBFtQaL7",
        "ixTj1aTMup2",
        "31DHHWieDMS",
        "aTf5zsbjZMb",
        "Xuky7E5df6A",
        "dTzYwo8Hppu",
        "kdw2Uapns3b",
        "U3oQjwTuMX8",
        "ECStCRoCNWM",
        "nd6Vw5SHCoy",
        "vKuDtqxh7YQ",
        "JFgrz9MNz4b",
        "5graSmdK3Bj",
        "h5VYFcePkbn",
        "ij6Fizhrr6c",
        "rWHyWNc6ZbZ",
        "mscxX4KEBcB",
        "1EiJpeRNEs1",
        "bxwHR9ipFG8",
        "EqZacbtdApE",
        "v3tsKAPVLJS",
        "EQSguCqe5Rk",
        "qmvPLqLAgvC",
        "LqsTKpxKVP2",
        "YJDUB7hWg9h",
        "d88Sc1udFcZ",
        "kubNyvKJBUX",
        "k3ohRuM6bso",
        "KsD3yx9nZCv",
        "DBjEcHFg4oq",
        "XVSZJAtHKdi",
        "3Ao63EY7J83",
        "Qkm4CooNoPi",
        "H8rQCnvBgo6",
        "deNrXzuSss5",
        "a3JCmxobR99",
        "3Y14etT7365",
        "wcJYziD5pmF",
        "ACZZiU6BXLz",
        "VhissfC8ggN",
        "fQHGxvurx9L",
        "UYrgg12a7QN",
        "yVbpFay8gTU",
        "j2DKmTV5TPV",
        "HkseAnWCgqk",
        "ikChNYDHtRf",
        "Y6WjWkVEUks",
        "Nf3aGQTDAA1",
        "D8aaq3PH6dG",
        "Yr35Q49vqwV",
        "Vnb6uKtzQCU",
        "wQN24R38a9N",
        "gxttMtT5ZGK",
        "SA759ShSs44",
        "oStKKWkQ1id",
        "wrq3kiEU4VR",
        "9DnDAhJ7qcj",
        "MyxM6trMBUH",
        "wuKkTq5GJbi",
        "7Xp37y8DpSv",
        "6TPCFES8fhh",
        "ceJTwFNjqCt",
        "e3YKRHQRPNe",
        "nYYcLpSzihC",
        "nACV8wLu1u5",
        "pEeGyoYCEa1",
        "4vwGX7U38Ux",
        "NBg5UqG3di3",
        "PB8eQHRTRRK",
        "ggNAcMh8JPT",
        "4dbCzNN5L5t",
        "E1NrAhMoqvB",
        "kA2nG18hCAr",
        "AENiMBDjVFb",
        "VaEwVD182FS",
        "f93a9wrxRjG",
        "uvveHdpUZis",
        "rPwrKEnR3fk",
        "bZsfeA9uRk7",
        "EgzWe8N3jZG",
        "udze1CSof5C",
        "fK2vEV32Lag",
        "nvjM2xMma91",
        "dNASL765WSN",
        "XNoaAZwsWKk",
        "yTgw14aa5ha",
        "AUkcTmUs8mw",
        "kdFEfVoT1WE",
        "F8Rw6EWpPRT",
        "ZKqtodH1qpa",
        "by8SK9u18S8",
        "33ypawbKCQf",
        "3goH1WRaCYC",
        "PM558qFsyi8",
        "77mMEyxhs44",
        "WnvnMQh4eEa",
        "TBdN234fGEb",
        "bXu6SSWkJY8",
        "j6fHrce9pHR",
        "ypcVfePF8TG",
        "1sPp3Wz8TCB",
        "VZy9kKQJcUF",
        "8EqKbkhqE4R",
        "z9VLaZqCsW5",
        "D5dEbkUphhr",
        "D8bT1ambLFc",
        "sfbj7jspYWj",
        "nW7z5USWzWo",
        "AfKhsVmG8L4",
        "mj5sKX44BmS",
        "nS8T59Aw3sf",
        "UbsJXeCkJBA",
        "AuGMayXVFkc",
        "9h5JJxM6E5S",
        "3z5dc2yzyCb",
        "tpxKD3awofe",
        "fFx6oC7EVp7",
        "qWP3MMQM3eJ",
        "CxxHb5C8ZsP",
        "yHLr6bvWsVm",
        "812QqCky3T7",
        "uzH9yHazm9t",
        "qWb4MVxqCW7",
        "X6Pct1msZv5",
        "vDfkYo5VqEQ",
        "P8L1328HrLi",
        "pUneSGJDrvY",
        "adgwjGh4NQK",
        "rxGLNxH6eoJ",
        "yqNxxJnA3iL",
        "SQqGpSHzfSr",
        "4RuxhXRmb3V",
        "kEL17iFsVbw",
        "mHJxL9jnCox",
        "c6TFyURFrL4",
        "LU4A39yR8gc",
        "RcuYAHzrjK7",
        "P6ajptD9tRP",
        "5biL7VEkByM",
        "adddVdvEXUK",
        "gjhYih4upQ9",
        "CthA7sQNTPK",
        "HjxjHvpdeoM",
        "xp4FyfQ6Wr5",
        "DoSbsoo4EAg",
        "mt5PhMmTk5m",
        "LQy8D2nmZ4x",
        "PYHRaSotJNh",
        "7UdY7HiDnUi",
        "oXzJVhUhmYe",
        "PUNuHY5M7MS",
        "awcRF7AZnJu",
        "mWqBmEyXcXN",
        "SSbSnMigayt",
        "X9fRPGxw1jS",
        "aqx6EomMgTf",
        "qpcpnP8TosR",
        "t3t9ofFLcFU",
        "enfahKs8XHw",
        "TzQLNfWugiZ",
        "EN7GiDgxdQ2",
        "YY8rqV6L6rf",
        "kZhZfAhdnNN",
        "1hovphK64XQ",
        "zUG6FL9TYeR",
        "saBtfCeVoJ4",
        "XiJhRLvpKpX",
        "wwX4MFiTTrt",
        "6nvpJEZ8ox5",
        "reHtN7VMWkg",
        "Gg8W275oKZE",
        "AwL2QGztLwV",
        "njMGKG4iwRK",
        "ZVPMj4YoZtK",
        "AiY2reLtjYJ",
        "N17ddiDvJr9",
        "XxbS57Z6PDU",
        "rmDFTEWfNcz",
        "y3K5dmhuukt",
        "8DDKELpgD99",
        "QKGMrurUVbk",
        "bDTsgcSK5Qr",
        "aJg466zMSNt",
        "kJxT5qssH4H",
        "MPPDV4Gvybr",
        "fdfRpE6Cfsr",
        "tEafuWwhhwr",
        "P3kZKzwnEbM",
        "uhkqDVMtEnn",
        "eip6PNoeCPr",
        "W3J8ruZTQic",
        "DS3nSAaa3Nr",
        "bEdki9cbHDG",
        "o4tckGBtaxz",
        "x4LVLSsYWcV",
        "2NwLiyeKcrK",
        "ZVScmfktNQ1",
        "zJEEFaNaRbB",
        "p4ZPcGtk6Ex",
        "KcHdFEzySGq",
        "BLhX6Do8f1t",
        "oz1yTAGPXkh",
        "SrHVAbHUpUX",
        "TYDavTf8oyy",
        "xGnehmjiCSA",
        "h6nwVLpAKQz",
        "NwG7cpZnRZb",
        "We1N7vBtyGm",
        "tvvDpjzFJGe",
        "LLecyBe5Eq2",
        "1W61QJVDBqe",
        "zWydhyFhvcj",
        "v46TaF2rxHK",
        "8m2Sk2sC3DR",
        "jGdNyKqGZJw",
        "4tdJ3qe1x7P",
        "1UnKg1rAb8A",
        "BCWtGkh8CHv",
        "qQgcM8T4hiD",
        "H7bBanejcc6",
        "q28T9C3q2dv",
        "5jLhtVmWd5F",
        "iePHCSf119p",
        "NfkadBDgBJV",
        "Am8wmPcBmtN",
        "Y4L8fjz2yH7",
        "giViJCyCH2C",
        "URjpCob8MGw",
        "W9YAR9qcuvN",
        "fRZhp6vWGw7",
        "HneuS3CYDFG",
        "UAByLdpaokx",
        "r38SGhq8aJr",
        "EbiLVt7CHc1",
        "8iCxzGNmp4g",
        "gDDiZeyaVc2",
        "q33GehreMrX",
        "S3YyrKoJ7k6",
        "pYGGNqSbHp1",
        "g7sKCMRfgUS",
        "Ze6tkhg7Wvc",
        "qSom26FpYzR",
        "z9w4aD7JsiQ",
        "WPzCkWEorzk",
        "WeyCwVzL53K",
        "PyZonHqd5gy",
        "r77mpaAYUEc",
        "mDdyQ6azhVD",
        "xWvSkKiWQpC",
        "uFCiZVVks57",
        "mDPCxA7W1WN",
        "UuwwmrTsfBN",
        "gUqgeUmUagL",
        "RTV2n6fXB2w",
        "TiWanpmC63V",
        "F1Vhvu3osn6",
        "gQ3xxshDiCz",
        "boHtwWDWtXh",
        "Wjvsh6jnVsR",
        "Hsk3jDzNySy",
        "o94q92w5PK5",
        "zR6kPe1PsyS",
        "LcAd9dhvVwh",
        "amdKHm5GAM1",
        "E9hxHD5h4FY",
        "TziyvKgzdAs",
        "gPf8XzHACGn",
        "3KZbo846fxq",
        "eWKqgQbVZow",
        "9K1WbyTZ456",
        "m17UDpW3tHm",
        "PFLHHbjscNN",
        "d6bYiL1d9Fh",
        "GNGYKt8XrjF",
        "DsEJeNPcZtE",
        "k9UfRPqLm3j",
        "8wJuSPJ9FXG",
        "r8b8sRuxdt2",
        "oKFJo8jpzRW",
        "dD37vuCa4FE",
        "C6JvMamYTRg",
        "c9DeZf2fcDf",
        "J5SkB2o1ckv",
        "GCEb4nmNi7j",
        "H77MhktmmAF",
        "nGhNxKrgBPb",
        "bHKTDQFJxTw",
        "A9yB3w3UxXV",
        "8nSVqHLMRwQ",
        "pmZMJfFd3Jy",
        "58fkJMgLopt",
        "suQdyWFG8g9",
        "HPrcqBkKzuy",
        "J9adB1bm54A",
        "53jtKd53a1X",
        "qz3829g1Lzf",
        "AdNTcRg3THp",
        "LPwS1aEGXBb",
        "WEDXu8bWRkq",
        "PPTLa8SkUfo",
        "qDjhFcNqFPi",
        "WZDzPCybQvS",
        "b3CuYvwpzZv",
        "XYQdAu1qsK9",
        "PjnDyQJJ3eM",
        "RamZzGBBPbT",
        "JUANmB8jduD",
        "cFqWyQ4Y9hT",
        "Coer9RdivP7",
        "6AGcGQf2wof",
        "hbr5fTQhAAa",
        "DfUQLukPMPc",
        "w5YEujJKsiy",
        "Mre6deDcPCP",
        "frThKkhTwFT",
        "E64sjs3Dyfd",
        "bpqKLXHnxei",
        "cHumXFzhHUR",
        "RHdkyzXFp1k",
        "osQy15y8EVT",
        "GZRLndzSrdn",
        "Y4idBN66BqG",
        "kxWk8ZMDE1N",
        "FnDDfrBZPhh",
        "N7YVmJQ8sAu",
        "k7vRbGpz44m",
        "otTm4oTrHvc",
        "aYhkzj2fEhP",
        "sLwz8nKD3wF",
        "dioA6agn1cP",
        "YM4nG4pSAEJ",
        "NkvRYHk72vA",
        "GfF9TQ34x37",
        "fxbzYAGkrtm",
        "16tymPtM7uS",
        "p32JzpQyhPk",
        "CtZLhCbWFm7",
        "4wCTuaUNWEd",
        "hXHUtviUKBu",
        "TNx8nti6GNi",
        "NjyeoK5BLx3",
        "kjUg7BaQF1C",
        "Xfhi9GYbhqD",
        "T4G9hTR5WSv",
        "6vJMULqvYe8",
        "aRKASs4e8j1",
        "gGMMut83nsX",
        "GPyDUnjwZQy",
        "NcK5aACg44h",
        "ZwnLFNzxASM",
        "8B43pG641ff",
        "GtM3JtRvvvR",
        "PuFu1zFVc4k",
        "vj4rZPfVjBQ",
        "LViDMxZp4ZN",
        "mkvHBa3mEEk",
        "41FNXLAZZgC",
        "NtnvZSMK3en"
    ],
    "val": [
        "1mCzDx3EMom",
        "2Pc8W48bu21",
        "eUJx9a4u63E",
        "QVAA6zecMHu",
        "315QujoX279",
        "cjLuWviyDEo",
        "WypGcNbCdsH",
        "226REUyJh2K",
        "mHXUEKEV6gR",
        "u9LiqMn6kA6",
        "kQVPtf7ACRw",
        "b3WpMbPFB6q",
        "CnU5RD6PB3E",
        "jTTGECZYKRA",
        "erfqyP5V4u6",
        "kXAEFtUBNFZ",
        "S3BfyR31Wc9",
        "7PZPFHR3oJc",
        "UAGeBzZJgkU",
        "fbUcgfPMBDr",
        "6BReaxZUoMg",
        "FgXPKxNp5kK",
        "8LLjiNrWzJ9",
        "5vUupbRRdyH",
        "F8PSGjTiv61",
        "DZsJKHoqEYg",
        "xAHnY3QzFUN",
        "d5faFfQRphr",
        "Fgtk7tL8R9Y",
        "LGGnLUDPz37",
        "ZhXWtW1gd6c",
        "6qJyEsZNuey",
        "QDtpZSqaeyW",
        "8mXffaQTtmP",
        "ENiCjXWB6aQ",
        "k7mcxHG65Wh",
        "SrBPiU6LKxL",
        "T7nCRmufFNR",
        "oahi4u45xMf",
        "CQWES1bawee",
        "XfUxBGTFQQb",
        "RHrFkyC59tf",
        "p6RF8AUer2e",
        "5737gQA9p2T",
        "vCfHLVSyL21",
        "XokRUNE3gB1",
        "yX54kr5c5g9",
        "uXU4dVyyvWa",
        "QKfBMSSy7Hy",
        "H81QMurNRM8",
        "n2Tt2eJdqnT",
        "MVVzj944atG",
        "2XVvKEDd54w",
        "1S7LAXRdDqK",
        "qnKYFQsjnHf",
        "HsYeeztxPG6",
        "KWoYKrff5L4",
        "j2eqyxdYAFW",
        "zCMdfYaW9iF",
        "nzuiinFMXvf",
        "NS5SeGunqiK",
        "jAzZDvf6i67",
        "t8wCA6Qe8uT",
        "mggziYKSc6S",
        "QxfX5te1gFu",
        "tjs8mFdJ7YN",
        "5m6t1y5EvsT",
        "HZ2iMMBsBQ9",
        "bCFcvb4zc3N",
        "6acdNdTjNbr",
        "XvJjCZv6SYp",
        "JWWJBQWHv64",
        "9Ckja165ren",
        "o1F5JVHc6mb",
        "nicaPonCxvC",
        "aNri5Gh1ZTE",
        "S7uMvxjBVZq",
        "AeBfp3hTadB",
        "C7xtw9uhYFn",
        "pVnwDTdMD3h",
        "iNpfPhK1sRz",
        "HfMobPm86Xn",
        "NRsmXFcVTbN",
        "6HMiy15cxis",
        "AqGu9nUng3L",
        "QN2dRqwd84J",
        "DNWbUAJYsPy",
        "wCqnXzoru3X",
        "Dj6sJyU7qmd",
        "Bnq6SeZGL5b",
        "TgWKHxhJAng",
        "iKFn6fzyRqs",
        "iTm2PKHUcTJ",
        "KAzjXJvZtR3",
        "duthTPisf28",
        "28FFMGySc6D",
        "WT4QWwXrMzs",
        "XNiSi1YgPRR",
        "t6tH2pNA9X5",
        "LVgQNuK8vtv",
        "ANmWrL7Kz7h",
        "zmZvNTCxMZE",
        "VoVGtfYrpuQ",
        "NtVbfPCkBFy",
        "NPHxDe6VeCc",
        "u5atqC7vRCY",
        "kDgLKdMd5X8",
        "BqLwEyiLbza",
        "tJ7XVoEN82a",
        "37c5w29pYm3",
        "FxCkHAfgh7A",
        "eZrc5fLTCmi",
        "cVppJowrUqs",
        "bAdy4hKf1a1",
        "BW1f54ZNVW6",
        "KHhgcNqsc9h",
        "4MRLu1yET6a",
        "SgkmkWjjmDJ",
        "j2EJhFEQGCL",
        "t85xiAt9pao",
        "s7kPJndncRy",
        "hWDDQnSDMXb",
        "2ihrkjrbHVf",
        "UQ5EhY5wve1",
        "MVStfLiYYQv",
        "qgZhhx1MpTi",
        "ghWQ5kHV97i",
        "aCtdWA5n56Z",
        "1xGrZPxG1Hz",
        "oEPjPNSPmzL",
        "GCCrNuhZ9WY",
        "RaYrxWt5pR1",
        "v7DzfFFEpsD",
        "C2hbxeJWmvX",
        "3PiKdwyfEkX",
        "pMntW4YkvvB",
        "XRHpoTZjtj7",
        "KCvzhHEhdwB",
        "SAZ4gvMfxm1",
        "FYYpmNC4gAd",
        "bwoBmU23M2N",
        "rK4jPRTUw15",
        "wtaQdtXzYtD",
        "rp42RknmRV8",
        "qvNra81N8BU",
        "xgLmjqzoAzF",
        "U8F9SkAsqbJ",
        "y4YiUQwvWGH",
        "EU6QPFpqdoU",
        "tAQTHnJ7n72",
        "z8SrvZ4eyqV",
        "4J8N2Ah1a6o",
        "MLVm7dZk7dp",
        "gmuS7Wgsbrx",
        "qAwGYe2GoZp",
        "NEVASPhcrxR",
        "P8XJUpcAUkf",
        "u9rPN5cHWBg",
        "C5RbHBQ76DE"
    ],
    }
}
OBJECT_CATEGORY_MAP = {}
INV_OBJECT_CATEGORY_MAP = {}
NUM_OBJECT_CATEGORIES = {}
OBJECT_CATEGORIES = {
    "gibson": [
        # Add Gibson categories here if needed
    ],
    "mp3d": [
        # Add MP3D categories here if needed
    ],
    "hm3d": [
        "out-of-bounds",  # idx 0
        "floor",          # idx 1
        "wall",           # idx 2
        "chair",
        "table",
        "bed",
        "sofa",
        "cabinet",
        "shelf",
        "desk",
        "lamp",
        "picture",
        "window",
        "door",
        "ceiling",
        "monitor",
        "tv",
        "stairs",
        "carpet",
        "counter"
    ]
}
for dset, categories in OBJECT_CATEGORIES.items():
    OBJECT_CATEGORY_MAP[dset] = {obj: idx for idx, obj in enumerate(categories)}
    INV_OBJECT_CATEGORY_MAP[dset] = {v: k for k, v in OBJECT_CATEGORY_MAP[dset].items()}
    NUM_OBJECT_CATEGORIES[dset] = len(categories)

# Define the minimum number of unique object categories (excluding floor/wall/out-of-bounds)
# required for a map to be considered valid during dataset loading.
MIN_OBJECTS_THRESH = 3 # You can adjust this value if needed (e.g., 5)

CAT_OFFSET = 1
FLOOR_ID = OBJECT_CATEGORY_MAP["hm3d"]["floor"] # Use the mapped ID for floor
WALL_ID = OBJECT_CATEGORY_MAP["hm3d"]["wall"] # Use the mapped ID for wall
OUT_OF_BOUNDS_ID = OBJECT_CATEGORY_MAP["hm3d"]["out-of-bounds"] # Use the mapped ID

# Modified version of d3_40_colors_rgb from habitat_sim.
d3_40_colors_rgb = np.array(
    [
        [31, 119, 180],
        [174, 199, 232],
        [255, 127, 14],
        [255, 187, 120],
        [44, 160, 44],
        [152, 223, 138],
        [206, 219, 156],
        [140, 109, 49],
        [148, 103, 189],
        [197, 176, 213],
        [140, 86, 75],
        [196, 156, 148],
        [227, 119, 194],
        [247, 182, 210],
        [127, 127, 127],
        [199, 199, 199],
        [188, 189, 34],
        [219, 219, 141],
        [23, 190, 207],
        [158, 218, 229],
        [57, 59, 121],
        [82, 84, 163],
        [107, 110, 207],
        [156, 158, 222],
        [99, 121, 57],
        [140, 162, 82],
        [181, 207, 107],
        [214, 39, 40],
        [255, 152, 150],
        [189, 158, 57],
        [231, 186, 82],
        [231, 203, 148],
        [132, 60, 57],
        [173, 73, 74],
        [214, 97, 107],
        [231, 150, 156],
        [123, 65, 115],
        [165, 81, 148],
        [206, 109, 189],
        [222, 158, 214],
    ],
    dtype=np.uint8,
)

# Color palette for Gibson from SemExp
gibson_palette = [
    1.0,
    1.0,
    1.0,  # Out of bounds
    0.6,
    0.6,
    0.6,  # Obstacle
    0.95,
    0.95,
    0.95,  # Free space
    0.96,
    0.36,
    0.26,  # Visible mask
    0.12156862745098039,
    0.47058823529411764,
    0.7058823529411765,  # Goal mask
    0.9400000000000001,
    0.7818,
    0.66,
    0.9400000000000001,
    0.8868,
    0.66,
    0.8882000000000001,
    0.9400000000000001,
    0.66,
    0.7832000000000001,
    0.9400000000000001,
    0.66,
    0.6782000000000001,
    0.9400000000000001,
    0.66,
    0.66,
    0.9400000000000001,
    0.7468000000000001,
    0.66,
    0.9400000000000001,
    0.8518000000000001,
    0.66,
    0.9232,
    0.9400000000000001,
    0.66,
    0.8182,
    0.9400000000000001,
    0.66,
    0.7132,
    0.9400000000000001,
    0.7117999999999999,
    0.66,
    0.9400000000000001,
    0.8168,
    0.66,
    0.9400000000000001,
    0.9218,
    0.66,
    0.9400000000000001,
    0.9400000000000001,
    0.66,
    0.8531999999999998,
    0.9400000000000001,
    0.66,
    0.748199999999999,
]

# HM3D semantic color mapping
hm3d_palette = np.array([
    [0, 0, 0],          # 0: out-of-bounds (black)
    [230, 230, 230],    # 1: floor (light gray)
    [77, 77, 77],       # 2: wall (dark gray)
    [31, 119, 180],     # chair
    [174, 199, 232],    # table
    [255, 127, 14],     # bed
    [255, 187, 120],    # sofa
    [44, 160, 44],      # cabinet
    [152, 223, 138],    # shelf
    [214, 39, 40],      # desk
    [255, 152, 150],    # lamp
    [148, 103, 189],    # picture
    [197, 176, 213],    # window
    [140, 86, 75],      # door
    [196, 156, 148],    # ceiling
    [227, 119, 194],    # monitor
    [247, 182, 210],    # tv
    [127, 127, 127],    # stairs
    [199, 199, 199],    # carpet
    [188, 189, 34]      # counter
], dtype=np.uint8)

HM3D_SEMANTIC_COLOR_MAP = {
    "out-of-bounds": [0, 0, 0],
    "floor": [230, 230, 230],
    "wall": [77, 77, 77],
    "chair": [31, 119, 180],
    "table": [174, 199, 232],
    "bed": [255, 127, 14],
    "sofa": [255, 187, 120],
    "cabinet": [44, 160, 44],
    "shelf": [152, 223, 138],
    "desk": [214, 39, 40],
    "lamp": [255, 152, 150],
    "picture": [148, 103, 189],
    "window": [197, 176, 213],
    "door": [140, 86, 75],
    "ceiling": [196, 156, 148],
    "monitor": [227, 119, 194],
    "tv": [247, 182, 210],
    "stairs": [127, 127, 127],
    "carpet": [199, 199, 199],
    "counter": [188, 189, 34]
}

# HM3D color palette
HM3D_OBJECT_COLORS = []  # Excluding 'out-of-bounds', 'floor', and 'wall'
for color in d3_40_colors_rgb[:len(OBJECT_CATEGORIES["hm3d"]) - 3]:
    color = (color.astype(np.float32) / 255.0).tolist()
    HM3D_OBJECT_COLORS.append(color)
